(function(n,t){function f(n,i){t(".jsWlListAccess").click(function(){var n=function(){return r(i),!1},u={callback:n,data:t("#wishListDisplayPopinForm").serialize(),isOverlayClick:!0,fullSize:!1,isOverflowHidden:!0,isPopinFullScreen:!0};t.popin.loadAjaxPopin(i.addProductToWishListHeartPopinUrl,u)})}function u(n,i){return i?(e=setTimeout(function(){t(n).hide()},800),!0):(clearTimeout(e),t(n).show(),!0)}t.init("BlocAddToWishListHeart",function(i){var e=t.extend({addProductLinkUrl:"",addProductToWishListHeartPopinUrl:"",checkAddProductLinkUrl:"",createNewListText:"",createWishListUrl:"",loginUrl:"",moveProductFromWishListToAnotherUrl:"",removeProductFromWishListUrl:"",maxItemsInWishList:50},i),h=n.document,r=t("#BlocAddToWishListHeart"),l=t("#inputWishlistHeart"),o=t("#wishListDisplayPopinForm"),a=t("#popinVariantError"),c,s;a.hide();t.isTouch()&&r.hide();t.nav.session.isAuthenticate()&&t.ajax({url:e.checkAddProductLinkUrl,cache:!1,data:o.serialize(),dataType:"html",type:"GET",success:function(n){var i,u;n!="null"&&(l[0].checked=!0,i=h.createElement("div"),i.className="popin WlPopinHeart jsWlPopinHeart WlPopinHeartTemp",t(i).hide(),r.append(i),u={callback:c,data:o.serialize(),isWaitingOverlayHidden:!0,isOverflowHidden:!1,isHidden:!0},t.popin.loadAjaxPopin(e.addProductLinkUrl,u))}});c=function(){return t.popin.hideOverlay(),f(h,e),!1};s=document.ontouchstart!==null?"click":"touchstart";t(".jsInputWishlistHeart",r).on(s,function(n){var f=t(this),i=t(".WlPopinHeartTemp",r),v,u,y;if(t.nav.session.isAuthenticate())if(l[0].checked||i.length!=0)s!="touchstart"||i.is(":visible")?t.ajax({url:e.removeProductFromWishListUrl,cache:!1,data:o.serialize(),dataType:"html",type:"GET",success:function(n){n!="null"&&i.remove()}}):(i.show(),n.preventDefault(),t(this).mouseenter());else{if(v=validateSelection(t(this).parent()),!v.isValide)return t(".jsWishlistHeart").addClass("WishlistHeartError"),s=="touchstart"&&t(this).mouseenter(),a.show(),!1;f.finish();f.animate({"background-size":"120%"},230).animate({"background-size":"100%"},230);t(".jsWishlistHeart").removeClass("WishlistHeartError");u=h.createElement("div");u.className="popin WlPopinHeart jsWlPopinHeart WlPopinHeartTemp";r.append(u);y={callback:c,data:o.serialize(),isWaitingOverlayHidden:!0,isOverflowHidden:!1};t.popin.loadAjaxPopin(e.addProductLinkUrl,y);t(u).show()}else window.location.href=e.loginUrl}).mouseenter(function(){t(this).finish();t(this).is(":animated")||t(this).animate({"background-size":"100%"},230)}).mouseleave(function(){t(this).finish();t(this).is(":animated")||t(this).animate({"background-size":"80%"},230)});r.mouseleave(function(){var n=t(".jsWlPopinHeart",r),i=t("#popinVariantError");t(".jsWlPopinHeart",t(this)).length>0?u(n,!0):u(i,!0)}).mouseenter(function(){var n=t(".jsWlPopinHeart",r);t(".jsWlPopinHeart",t(this)).length>0&&u(n,!1)});t("body").on("click",".jsCancelCreation",function(){var n=t("#BlocAddToWishListHeart"),i=t(".jsInputWishlistHeart",n);t.popin.hideOverlay()}).on("focusin",".jsWlHeartCreateTitle input",function(){t("#WlHeartPopinList .jsWlHeartCreationFailed").remove();var n=t(this).next(),i=t(this).parent().prev();i.addClass("WlHeartCreateDisplayBlock");t("#WishListCreationFormData_WishListName").removeClass("error").removeClass("WlHeartCreateTitleRedUnderline");t(this).attr("placeholder","");n.is(":visible")&&n.removeClass("WlHeartCreateDisplayBlock")}).on("focusout",".jsWlHeartCreateTitle input",function(){var n=t(this).val(),i=t(this).parent().prev();n.trim()==""&&(i.removeClass("WlHeartCreateDisplayBlock"),n!=""&&t(this).val(""),t(this).attr("placeholder",e.createNewListText))}).touch(function(n){var i=t(".jsInputWishlistHeart",r);t(n.target).is(i)||i.mouseleave()})});var r=function(u){var s=t("body"),e=t("#WlHeartPopinList"),h=t(".jsWlHeartListContent",e),o=t(".jsWlHeartCreateNewList",e);s.each(function(){t(this).on("click",".jsWlHeartListAccess",function(n){n.stopPropagation()});t(this).on("click",".popinFull",function(){t(".jsWlHeartMaxCountReachedMessage").hasClass("WlHeartMaxCountReachedHidden")||(t(".jsWlHeartMaxCountReachedMessage").addClass("WlHeartMaxCountReachedHidden"),t(".jsWlHeartList.WlHeartListRedBorder",e).removeClass("WlHeartListRedBorder"))});t(this).on("click",".jsWlHeartBlockList li",function(n){var h,f;if(t(".jsWlHeartText>span",t(this))[0].innerText.split("(").pop().replace(")","")>=u.maxItemsInWishList&&!t(this).find("#SelectedListId").checked){n.preventDefault();n.stopPropagation();t(".jsWlHeartMaxCountReachedMessage").removeClass("WlHeartMaxCountReachedHidden");t(n.target).parents(".jsWlHeartList").addClass("WlHeartListRedBorder");t(".jsWlHeartList.WlHeartListRedBorder",e).not(t(n.target).parents(".jsWlHeartList.WlHeartListRedBorder")).removeClass("WlHeartListRedBorder");return}var r=t(".jsWlHeartBlockList",s),o=t(n.target),c=!o.hasClass("jsOverlayContent")&&!o.parents(".jsOverlayContent").length>0;if(c){h=t(this).find(".jsWlHeartCheckbox input[type=checkbox]");f=t(".jsWlHeartText>span",t(this));$previouslyChecked=t("li.jsWlHeartCheckedList",r);$previouslyCheckedText=t(".jsWlHeartText>span",$previouslyChecked);incrOrDecr=function(n,t){var r=n.toString().split("("),o=r.pop(),s=r.length,u=o.substring(0,o.length-1),f=Number(u),e="";for(t?f++:f--,u=f.toString(),i=0;i<s;i++)e=e+r[i]+"(";return e+u+")"};$previouslyCheckedText[0].innerText=incrOrDecr($previouslyCheckedText[0].innerText,!1);f[0].innerText=incrOrDecr(f[0].innerText,!0);h.prop("checked",!0);t(this).addClass("WlHeartCheckedList jsWlHeartCheckedList");t("li",r).not(this).find(".jsWlHeartCheckbox input[type=checkbox]").prop("checked",!1);t(".jsWlHeartList",r).not(this).removeClass("WlHeartCheckedList jsWlHeartCheckedList");return}});t(".jsWlHeartCreateButton",this).on("click",function(){var i=t("#WishListCreationFormData_WishListName"),f=t(this).prev().children().last(),e=i.val().trim(),n;e==""?(i.addClass("WlHeartCreateTitleRedUnderline"),f.addClass("WlHeartCreateDisplayBlock")):(n=t(this).parents("form"),n.ajaxSubmit({url:u.createWishListUrl,data:n.serialize(),dataType:"json",success:function(n){var f,e,i;n&&(n.IsOperationSuccess?(f=function(){return r(u),t("#WlHeartPopinList .jsWlHeartList:eq(1)").click(),!1},e={callback:f,data:t("#wishListDisplayPopinForm").serialize(),isOverlayClick:!0,fullSize:!1,isOverflowHidden:!0,isPopinFullScreen:!0},t("#overlay .jsCancel").click(),t.popin.loadAjaxPopin(u.addProductToWishListHeartPopinUrl,e),t("#WishListCreationFormData_WishListProductForm_WishListItemDataCount").val(n.WishListCount),t.getScript({text:n.Script})):(o.html(n.html),r(u),i=t("#WishListCreationFormData_WishListName"),i.addClass("WlHeartCreateTitleRedUnderline"),i.addClass("error")))}}))});t(".jsWlValidateChanges",this).on("click",function(){var i=h.find("form");t.ajax({url:u.moveProductFromWishListToAnotherUrl,cache:!1,data:i.serialize(),dataType:"json",type:"GET",success:function(i){i&&i.IsOperationSuccess&&($firstPopin=t("#BlocAddToWishListHeart .jsWlPopinHeart"),$firstPopin.html(i.html),f(n.document,u))}});t(".jsCancel","#overlay").click()});t(".jsWlHeartCreationTxt",o).keydown(function(n){n.keyCode==13&&(event.preventDefault(),t(".jsWlHeartCreateButton",o).click())})})},e})(window,window.jQuery||window.cm);
//# sourceMappingURL=wishListHeart.js.map

//# sourceMappingURL=wishListHeart.js.map
